---
uuid: 0cfb35c0-49de-11ec-89f9-49447d13d736
title: 数据类型
date: 2021-11-20 16:33:35
tags: 基础知识
---

#### 导读

<!-- toc -->

!!! note "按语"
    数据类型是JavaScript核心的基础知识点，碎片文章比较多但不够全面，关于一些疑难点也并无总结，对于新同学上手而言往往是云里雾里。本文全面剖析且言简意赅，希望读者喜欢。

### 为什么学习编程语言的数据类型？

我们知道计算机程序=算法+数据结构，数据结构是指相互之间存在一种或多种特定关系的数据元素的集合。数据类型就是数据元素的一种组织形式，学习和理解数据类型对我们编写高质量的程序至关重要。

### JavaScript 的数据类型有哪些？

最新的 ECMAScript 标准定义了 8 种数据类型: **undefined**、 **boolean**、 **number**、 **string**、 **bingint**、 **symbol**、 **null**、 **object**，其中除了 object 之外都是基本数据类型。

如果想判断变量的数据类型，可以借助 JavaScript 语法提供的 **typeof** 关键字。

```js
typeof undefined === 'undefined'
typeof true ==='boolean'
typeof 2021 === 'number'
typeof 'hello' === 'string'
typeof BigInt(1) === 'bigint'
typeof Symbol(2) === 'symbol'
typeof null === 'object'            // 注意是 object 而不是 null
typeof {} === 'object'
typeof function(){} === 'function'  // 注意是 function 而不是 object
```

细心的同学不难发现上述代码的运行结果有两个“疑点”：

1.  null 的数据类型竟然不是 null 而是 object :question:
2.  按照 ECMAScript 定义的数据类型并不包括 function 而 typeof 竟然返回了 function :question:

我们来看下第一个问题，[官方](https://tc39.es/ecma262/#sec-terms-and-definitions-null-type)是这么定义的：

> 4.4.16 Null type
> type whose sole value is the null value

这句话的意思一个被赋值 null 的变量的数据类型是 null，用代码表示就是：

```js
let a = null
typeof a === 'null'
```

但实际上是运行结果如下：

```js
let a = null
typeof a === 'undefined'
```

换句话说 null 是理论上的基本数据类型之一，但在实际中并未被执行，多个文章都将其描述为“[历史原因](https://2ality.com/2013/10/typeof-null.html)”所致，有兴趣可以自行阅读。如果没有时间阅读也可以参考 MDN 的描述：

> 在 JavaScript 最初的实现中，JavaScript 中的值是由一个表示类型的标签和实际数据值表示的。对象的类型标签是 0。由于 null 代表的是空指针（大多数平台下值为 0x00），因此，null 的类型标签是 0，typeof null 也因此返回 "object"。

再来看下第二个问题，为什么 typeof 返回了一个不在定义范围内的数据类型，经过查阅 ecma262 标准得出了答案，总结如下：

1.  JavaScript 一切都是对象，而 function 也是 object 的一种。
2.  如何区分 function object 还是 normal object，是需要看 object 有没有实现 \[[Call]] 这个内置方法，具体[参考](https://tc39.es/ecma262/#sec-ecmascript-function-objects-call-thisargument-argumentslist)。
3.  typeof 在计算 object 类型时会检查  \[[Call]] 内置方法是否被实现，实现了返回 function 没实现则返回 object。

<table style="margin:0 30%;">
<tbody>
  <tr>
    <th>Type of <var>val</var></th>
    <th>Result</th>
  </tr>
  <tr>
    <td>Undefined</td>
    <td><emu-val>"undefined"</emu-val></td>
  </tr>
  <tr>
    <td>Null</td>
    <td><emu-val>"object"</emu-val></td>
  </tr>
  <tr>
    <td>Boolean</td>
    <td><emu-val>"boolean"</emu-val></td>
  </tr>
  <tr>
    <td>Number</td>
    <td><emu-val>"number"</emu-val></td>
  </tr>
  <tr>
    <td>String</td>
    <td><emu-val>"string"</emu-val></td>
  </tr>
  <tr>
    <td>Symbol</td>
    <td><emu-val>"symbol"</emu-val></td>
  </tr>
  <tr>
    <td>BigInt</td>
    <td><emu-val>"bigint"</emu-val></td>
  </tr>
  <tr>
    <td>Object (does not implement [[Call]])</td>
    <td><emu-val>"object"</emu-val></td>
  </tr>
  <tr>
    <td>Object (implements [[Call]])</td>
    <td><emu-val>"function"</emu-val></td>
  </tr>
</tbody>
</table>

### 辨别不同的对象类型

我们根据 typeof 运算符可以识别基本数据类型，但是 object 对象有很多，比如 Array、Date、Number、Map、Set等等。如何识别这些对象类型靠 typeof 已经无法满足要求，基础扎实的同学还能想到 instanceof 来判断对象实例是不是属于某个类(对象)。

```js
let a = [1,2,3]
let b = new Map
a instanceof Array  // true
b instanceof Map    // true
```

这种方法可以对某个类型做具体的判断更为合适，比如判断某个变量是不是数组。不然，每次将不断枚举所有类型执行效率非常低。

善于学习的同学们肯定发现了可以通过 object.toString() 来判断，比如：

```js
let obj = { a: 1}
console.log(obj.toString())     // [object Object]
console.log(Math.toString())    // [object Math]
console.log(JSON.toString())    // [object JSON]
```

toString 方法都是集成 Object 对象而来，不过有的对象已经将该方法重写，比如：

```js
console.log(Map.toString())     // function Map() { [native code] }
console.log(Date.toString())    // function Date() { [native code] }
console.log(Symbol.toString())  // function Symbol() { [native code] }
console.log(Array.toString())   // function Array() { [native code] }
```

所以我们可以直接使用 Object.toString 方法来实现，代码如下：

```js
Object.prototype.toString.call([])                 // [object Array]
Object.prototype.toString.call(1)                  // [object Number]
Object.prototype.toString.call('abc')              // [object String]
Object.prototype.toString.call(true)               // [object Boolean]
Object.prototype.toString.call(undefined)          // [object Undefined]
Object.prototype.toString.call(Symbol(2))          // [object Symbol]
Object.prototype.toString.call({})                 // [object Object]
Object.prototype.toString.call(new Date)           // [object Date]
Object.prototype.toString.call(function(){})       // [object Function]
Object.prototype.toString.call(new Set)            // [object Set]
Object.prototype.toString.call(new Map)            // [object Map]
Object.prototype.toString.call(new RegExp('\s'))   // [object RegExp]
Object.prototype.toString.call(Math)               // [object Math]
Object.prototype.toString.call(function*(){})      // [object GeneratorFunction]
```

这些代码稍微改造就可以直接得到具体的对象类型：

```js
Object.prototype.toString.call([]).match(/(?!\s)\S+(?=])/)[0] // Array
```

有同学比较好奇 <var>Object.toString</var> 为何如此神通广大，里面到底有什么摩斯密码 :question:

想弄清楚这个问题就要了解 <var>[Symbol.toStringTag](https://tc39.es/ecma262/#sec-tostring)</var>

### 数据类型常见的考查方式有哪些？

1.  题目1

```js
typeof function(){}       // object || function ✔️
typeof new Function       // object ✔️ || function
typeof new Array          // object ✔️ || array || function
typeof class A {}         // object || function ✔️
```

2.  题目2

```js
typeof NaN              // undefined || null || number ✔️
typeof Infinity         // undefined || null || number ✔️
typeof new Number()     // number || object ✔️
typeof Number()         // number ✔️ || object
```

3.  题目3

```js
typeof (typeof 1)  // undefined || string ✔️
```

4.  题目4

```js
typeof (typeof 1)  // undefined || string
```

### 如何深入理解数据类型转换？

1.  初识 Symbol.toStringTag
2.  理解 Object.prototype.toString
3.  理解 [Instance].prototype.toString

-   <https://zhuanlan.zhihu.com/p/118793721>
-   <https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/toStringTag>
